<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎯 Quiz Game - Cyber-Style</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/kahoot-style.css') }}">
    <link rel="icon"
          href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🎯</text></svg>">
</head>
<body>
<div class="main-container">
    <!-- Theme Toggle -->
    <div class="theme-toggle dark" id="themeToggle" onclick="toggleTheme()">
        <span class="theme-icon sun-icon">☀️</span>
        <span class="theme-icon moon-icon">🌙</span>
    </div>

    <h1 class="fade-in">🎯 Interactive Quiz Game</h1>
    <p class="subtitle fade-in" style="text-align: center; font-size: 1.2rem; color: var(--text-dim); margin-bottom: 3rem; font-weight: 500; animation-delay: 0.2s;">
        Lernen, spielen und Spaß haben - im modernen Style!
    </p>

    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="flash-messages fade-in">
        {% for category, message in messages %}
        <div class="flash-message {{ category }}" role="alert" aria-live="polite">
            {% if category == 'error' %}⚠️{% elif category == 'success' %}✅{% elif category == 'warning' %}⚡{% else %}💡{% endif %} 
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <div class="host-dashboard slide-up">
        <div class="dashboard-card">
            <div class="dashboard-icon">🎮</div>
            <h3>Solo-Modus</h3>
            <p>Spiele alleine und teste dein Wissen in verschiedenen Kategorien.</p>
            <a href="#solo-form" class="btn btn-primary" onclick="showSoloForm()">Solo spielen</a>
        </div>
        <div class="dashboard-card">
            <div class="dashboard-icon">🚀</div>
            <h3>Spiel beitreten</h3>
            <p>Trete einem bestehenden Quiz mit einer PIN bei.</p>
            <a href="{{ url_for('player.join_game') }}" class="btn btn-warning">PIN eingeben</a>
        </div>
        <div class="dashboard-card">
            <div class="dashboard-icon">✍️</div>
            <h3>Als Spielleiter</h3>
            <p>Erstelle ein Multiplayer-Quiz oder eigene Fragen-Sets.</p>
            <a href="{{ url_for('host.host_dashboard') }}" class="btn btn-success">Quiz hosten</a>
        </div>
        <div class="dashboard-card">
            <div class="dashboard-icon">📈</div>
            <h3>Statistiken</h3>
            <p>Verfolgen Sie Ihren Fortschritt und sehen Sie Ihre Erfolge.</p>
            <a href="{{ url_for('player.stats') }}" class="btn btn-danger">Statistiken</a>
        </div>
        <div class="dashboard-card">
            <div class="dashboard-icon">🏆</div>
            <h3>Achievements</h3>
            <p>Sammle Erfolge und schalte besondere Belohnungen frei.</p>
            <a href="{{ url_for('player.achievements') }}" class="btn btn-primary">Achievements</a>
        </div>
    </div>

    <div class="card slide-up" id="solo-form" style="animation-delay: 0.3s; display: none;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
            <h2 style="margin: 0;">🎮 Solo-Quiz starten</h2>
            <button type="button" onclick="showDashboard()" class="btn btn-warning" style="padding: 0.5rem 1rem; font-size: 0.9rem;">
                ← Zurück
            </button>
        </div>
        <form action="{{ url_for('player.start_quiz') }}" method="post" class="loading-form">
            <div class="form-group">
                <label class="form-label" for="player_name">👤 Dein Name</label>
                <input type="text" id="player_name" name="player_name" class="form-control" 
                       placeholder="Gib deinen Namen ein" required maxlength="20" 
                       autocomplete="username" aria-describedby="name-help">
                <small id="name-help" style="color: var(--text-dim); font-size: 0.9rem;">2-20 Zeichen</small>
            </div>
            <div class="form-group">
                <label class="form-label">Spielmodus</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" id="mode_difficulty" name="mode" value="difficulty" checked>
                        <label for="mode_difficulty">Nach Schwierigkeit</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" id="mode_random" name="mode" value="random">
                        <label for="mode_random">Zufällig</label>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label" for="difficulty">⭐ Schwierigkeitsgrad</label>
                <select id="difficulty" name="difficulty" class="form-control" aria-describedby="difficulty-help">
                    <option value="easy">🟢 Einfach (Grundwissen)</option>
                    <option value="medium" selected>🟡 Mittel (Allgemeinwissen)</option>
                    <option value="hard">🟠 Schwer (Expertenwissen)</option>
                    <option value="heavy">🔴 Sehr Schwer (Spezialistenwissen)</option>
                </select>
                <small id="difficulty-help" style="color: var(--text-dim); font-size: 0.9rem;">Wählen Sie Ihr bevorzugtes Niveau</small>
            </div>
            <div class="form-group">
                <label class="form-label" for="language">Sprache</label>
                <select id="language" name="language" class="form-control">
                    <option value="de">🇩🇪 Deutsch</option>
                    <option value="en">🇺🇸 English</option>
                </select>
            </div>
            <div style="text-align: center; margin-top: 2rem;">
                <button type="submit" class="btn btn-primary submit-btn">🚀 Quiz starten</button>
            </div>
        </form>
    </div>
</div>
<script>
    // Theme toggle functionality
    function toggleTheme() {
        const body = document.body;
        const themeToggle = document.getElementById('themeToggle');
        const currentTheme = localStorage.getItem('theme') || 'dark';
        const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
        
        body.setAttribute('data-theme', newTheme);
        themeToggle.className = `theme-toggle ${newTheme}`;
        localStorage.setItem('theme', newTheme);
    }
    
    // Initialize theme
    function initTheme() {
        const savedTheme = localStorage.getItem('theme') || 'dark';
        const body = document.body;
        const themeToggle = document.getElementById('themeToggle');
        
        body.setAttribute('data-theme', savedTheme);
        themeToggle.className = `theme-toggle ${savedTheme}`;
    }

    // Show solo form and hide dashboard
    function showSoloForm() {
        const soloForm = document.getElementById('solo-form');
        const dashboard = document.querySelector('.host-dashboard');
        
        // Smooth transition
        dashboard.style.transition = 'opacity 0.3s ease';
        dashboard.style.opacity = '0';
        
        setTimeout(() => {
            dashboard.style.display = 'none';
            soloForm.style.display = 'block';
            soloForm.style.opacity = '0';
            soloForm.style.transition = 'opacity 0.3s ease';
            
            // Smooth scroll and fade in
            soloForm.scrollIntoView({ behavior: 'smooth' });
            setTimeout(() => {
                soloForm.style.opacity = '1';
                // Focus first input
                const firstInput = soloForm.querySelector('input[type="text"]');
                if (firstInput) firstInput.focus();
            }, 100);
        }, 300);
    }

    // Back to dashboard function
    function showDashboard() {
        const soloForm = document.getElementById('solo-form');
        const dashboard = document.querySelector('.host-dashboard');
        
        soloForm.style.opacity = '0';
        setTimeout(() => {
            soloForm.style.display = 'none';
            dashboard.style.display = 'grid';
            dashboard.style.opacity = '1';
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }, 300);
    }

    document.addEventListener('DOMContentLoaded', function() {
        // Initialize theme
        initTheme();
        
        // Add loading states to forms
        document.querySelectorAll('.loading-form').forEach(form => {
            form.addEventListener('submit', function(event) {
                const submitBtn = this.querySelector('.submit-btn');
                if (submitBtn) {
                    submitBtn.innerHTML = '🔄 Wird geladen...';
                    submitBtn.disabled = true;
                }
            });
        });
        
        // Add hover effects to dashboard cards
        document.querySelectorAll('.dashboard-card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-5px) scale(1.02)';
                this.style.boxShadow = '0 12px 25px rgba(0, 255, 255, 0.2)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
                this.style.boxShadow = '';
            });
        });
        
        // Add keyboard navigation
        document.addEventListener('keydown', function(event) {
            // ESC key to go back to dashboard
            if (event.key === 'Escape') {
                const soloForm = document.getElementById('solo-form');
                if (soloForm.style.display !== 'none' && soloForm.style.display !== '') {
                    showDashboard();
                }
            }
        });
    });
</script>
</body>
</html>